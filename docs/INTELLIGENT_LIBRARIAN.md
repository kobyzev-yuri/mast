# –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä—å –¥–ª—è Knowledge Base

## –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä—å (Intelligent Librarian) - —ç—Ç–æ AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–≥–∞–µ—Ç —Å–æ–±–∏—Ä–∞—Ç—å, –æ—Ä–≥–∞–Ω–∏–∑–æ–≤—ã–≤–∞—Ç—å, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ —É–ª—É—á—à–∞—Ç—å –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—É—é –±–∞–∑—É –∑–Ω–∞–Ω–∏–π –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –º–∞—Å—Ç–æ—Ü–∏—Ç–æ–≤.

## –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### 1. –ü–æ–º–æ—â–Ω–∏–∫ –ø–æ —Å–±–æ—Ä—É –¥–∞–Ω–Ω—ã—Ö (Data Collector)

**–ó–∞–¥–∞—á–∏:**
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ KB –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—Ä–æ–±–µ–ª—ã
- –ü—Ä–µ–¥–ª–∞–≥–∞–µ—Ç, –∫–∞–∫–∏–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –¥–æ–±–∞–≤–ª—è–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏ –ø–∞—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–ì/–≠ + –ò–ì–•)

**–ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π:**
```
üìä –ê–Ω–∞–ª–∏–∑ KB:
- Hard Positives: 45/100 (–Ω—É–∂–Ω–æ –µ—â–µ 55)
  ‚ö†Ô∏è –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤–µ—Ä–µ—Ç–µ–Ω–æ–≤–∏–¥–Ω—ã—Ö –º–∞—Å—Ç–æ—Ü–∏—Ç–æ–≤ (—Ç–æ–ª—å–∫–æ 8 –∏–∑ 50)
  ‚úÖ –•–æ—Ä–æ—à–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –¥–µ–≥—Ä–∞–Ω—É–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö (42/50)
  
- Hard Negatives: 120/250 (–Ω—É–∂–Ω–æ –µ—â–µ 130)
  ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –º–∞–ª–æ –ø–ª–∞–∑–º–æ—Ü–∏—Ç–æ–≤ —Å —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–º —è–¥—Ä–æ–º (5 –∏–∑ 50)
  ‚úÖ –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ñ–∏–±—Ä–æ–±–ª–∞—Å—Ç–æ–≤ (48/50)

üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
1. –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –¥–æ–±–∞–≤–∏—Ç—å –≤–µ—Ä–µ—Ç–µ–Ω–æ–≤–∏–¥–Ω—ã–µ –º–∞—Å—Ç–æ—Ü–∏—Ç—ã (Hard Positive)
2. –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –¥–æ–±–∞–≤–∏—Ç—å –ø–ª–∞–∑–º–æ—Ü–∏—Ç—ã —Å —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–º —è–¥—Ä–æ–º (Hard Negative)
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –ø–∞—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–ì/–≠ + –ò–ì–•) –¥–ª—è –Ω–æ–≤—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤
```

### 2. –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –∫–∞—á–µ—Å—Ç–≤–∞ KB (Quality Analyzer)

**–ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞:**
- **–ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö** - —Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–æ–≤ –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞
- **–ë–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤** - —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ Hard Positives / Hard Negatives
- **–ö–∞—á–µ—Å—Ç–≤–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö** - –ø–æ–ª–Ω–æ—Ç–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–π
- **–ö–∞—á–µ—Å—Ç–≤–æ –ø–∞—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** - –Ω–∞–ª–∏—á–∏–µ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ì/–≠ + –ò–ì–•
- **–†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –ø—Ä–∏–º–µ—Ä–æ–≤** - —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏, –ª–æ–∫–∞—Ü–∏—è–º, —Ç–∏–ø–∞–º —Ç–∫–∞–Ω–µ–π

**–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:**
- –ì—Ä–∞—Ñ–∏–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ —Ç–∏–ø–∞–º
- –ö–∞—Ä—Ç—ã –ø–æ–∫—Ä—ã—Ç–∏—è (heatmaps)
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º
- –ê–Ω–∞–ª–∏–∑ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –∏ –ø–æ—Ö–æ–∂–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤

### 3. –î–≤–∏–≥–∞—Ç–µ–ª—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π (Suggestion Engine)

**–¢–∏–ø—ã –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π:**

#### A. –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —Å–±–æ—Ä—É –¥–∞–Ω–Ω—ã—Ö
```
üéØ –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —Å–±–æ—Ä—É:
1. –î–æ–±–∞–≤–∏—Ç—å 10 –ø—Ä–∏–º–µ—Ä–æ–≤ –≤–µ—Ä–µ—Ç–µ–Ω–æ–≤–∏–¥–Ω—ã—Ö –º–∞—Å—Ç–æ—Ü–∏—Ç–æ–≤ –∏–∑ –∂–µ–ª—É–¥–∫–∞
   –ü—Ä–∏—á–∏–Ω–∞: –Ω–∏–∑–∫–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —ç—Ç–æ–≥–æ —Ç–∏–ø–∞ –≤ –∂–µ–ª—É–¥–æ—á–Ω–æ–π —Ç–∫–∞–Ω–∏
   –ò—Å—Ç–æ—á–Ω–∏–∫: data/datasets/hard_positives/spindle_shaped/

2. –î–æ–±–∞–≤–∏—Ç—å 15 –ø—Ä–∏–º–µ—Ä–æ–≤ –ø–ª–∞–∑–º–æ—Ü–∏—Ç–æ–≤ —Å —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–º —è–¥—Ä–æ–º
   –ü—Ä–∏—á–∏–Ω–∞: –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è —Ä–∞–∑–ª–∏—á–∏—è–º
   –ò—Å—Ç–æ—á–Ω–∏–∫: data/datasets/hard_negatives/plasmocytes_central/
```

#### B. –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é KB
```
üîß –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é:
1. –û–±–Ω–æ–≤–∏—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –¥–ª—è 23 –ø—Ä–∏–º–µ—Ä–æ–≤ —Å –Ω–µ–ø–æ–ª–Ω—ã–º–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
   –î–µ–π—Å—Ç–≤–∏–µ: –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ —Å –ø–æ–ª–Ω—ã–º–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏

2. –î–æ–±–∞–≤–∏—Ç—å distinguishing_features –¥–ª—è 12 Hard Negatives
   –î–µ–π—Å—Ç–≤–∏–µ: –ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø–æ–ª—è –æ—Ç–ª–∏—á–∏–π –æ—Ç –º–∞—Å—Ç–æ—Ü–∏—Ç–æ–≤

3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø–∞—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è 8 –ø—Ä–∏–º–µ—Ä–æ–≤
   –î–µ–π—Å—Ç–≤–∏–µ: –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ì/–≠ + –ò–ì–•
```

#### C. –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
```
üß™ –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é:
1. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∏—Å–∫ –ø–æ –∑–∞–ø—Ä–æ—Å—É "–≤–µ—Ä–µ—Ç–µ–Ω–æ–≤–∏–¥–Ω—ã–µ –º–∞—Å—Ç–æ—Ü–∏—Ç—ã"
   –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: —Ç–æ–ø-5 –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤–µ—Ä–µ—Ç–µ–Ω–æ–≤–∏–¥–Ω—ã–º–∏
   
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é Hard Negatives
   –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: is_mast_cell=false –¥–ª—è –≤—Å–µ—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
```

### 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ KB (Test Runner)

**–¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤:**

#### A. –¢–µ—Å—Ç—ã –ø–æ–∏—Å–∫–∞ (Search Tests)
```python
# –¢–µ—Å—Ç 1: –ü–æ–∏—Å–∫ Hard Positives
query = "spindle-shaped mast cell with elongated nucleus"
results = kb.search_similar(query, filter_dataset_category="hard_positive")
assert all(r['metadata']['hard_positive_type'] == 'spindle_shaped' 
           for r in results[:3]), "–¢–æ–ø-3 –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤–µ—Ä–µ—Ç–µ–Ω–æ–≤–∏–¥–Ω—ã–º–∏"

# –¢–µ—Å—Ç 2: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è Hard Negatives
query = "cell with central nucleus"
results = kb.search_similar(query, filter_is_mast_cell=False)
assert all(r['metadata']['is_mast_cell'] == 'false' 
           for r in results), "–í—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ù–ï –º–∞—Å—Ç–æ—Ü–∏—Ç–∞–º–∏"
```

#### B. –¢–µ—Å—Ç—ã –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö (Data Quality Tests)
```python
# –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
all_examples = kb.get_all_examples()
for ex in all_examples:
    assert 'morphological_features' in ex['metadata'], "–ù–µ—Ç –º–æ—Ä—Ñ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤"
    assert 'cell_type' in ex['metadata'] or ex['metadata'].get('is_mast_cell'), "–ù–µ—Ç —Ç–∏–ø–∞ –∫–ª–µ—Ç–∫–∏"

# –¢–µ—Å—Ç 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è Hard Positives
hard_positives = [ex for ex in all_examples 
                  if ex['metadata'].get('dataset_category') == 'hard_positive']
for hp in hard_positives:
    assert hp['metadata'].get('has_paired_ihc') == 'yes', "Hard Positive –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –ø–∞—Ä–Ω–æ–µ –ò–ì–•"
```

#### C. –¢–µ—Å—Ç—ã –±–∞–ª–∞–Ω—Å–∞ (Balance Tests)
```python
# –¢–µ—Å—Ç: –ë–∞–ª–∞–Ω—Å Hard Positives / Hard Negatives
hp_count = len([ex for ex in all_examples 
                if ex['metadata'].get('dataset_category') == 'hard_positive'])
hn_count = len([ex for ex in all_examples 
                if ex['metadata'].get('dataset_category') == 'hard_negative'])

ratio = hp_count / hn_count if hn_count > 0 else 0
assert 0.5 <= ratio <= 2.0, f"–ù–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ: {ratio:.2f}"
```

#### D. –¢–µ—Å—Ç—ã –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ—Å—Ç–∏ (Multimodal Tests)
```python
# –¢–µ—Å—Ç: –ü–æ–∏—Å–∫ –ø–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é
test_image = Path("data/datasets/hard_positives/spindle_shaped/001_he.png")
similar_images = kb.search_similar_images(test_image, n_results=5)
assert len(similar_images) > 0, "–î–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–∞–π–¥–µ–Ω—ã –ø–æ—Ö–æ–∂–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è"
assert all(img['metadata']['hard_positive_type'] == 'spindle_shaped' 
           for img in similar_images[:3]), "–¢–æ–ø-3 –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤–µ—Ä–µ—Ç–µ–Ω–æ–≤–∏–¥–Ω—ã–º–∏"
```

### 5. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏ –æ—Ç—á–µ—Ç—ã

**–î–∞—à–±–æ—Ä–¥ KB:**
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–∏–ø–∞–º –¥–∞–Ω–Ω—ã—Ö
- –ì—Ä–∞—Ñ–∏–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
- –ö–∞—Ä—Ç—ã –ø–æ–∫—Ä—ã—Ç–∏—è
- –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

**–û—Ç—á–µ—Ç—ã:**
- –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ KB
- –û—Ç—á–µ—Ç –æ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –û—Ç—á–µ—Ç –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä—è

```python
class IntelligentLibrarian:
    """–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä—å –¥–ª—è KB"""
    
    def __init__(self, kb_path: str):
        self.kb = MastCellsKnowledgeBase(db_path=kb_path)
        self.data_collector = DataCollector(self.kb)
        self.quality_analyzer = QualityAnalyzer(self.kb)
        self.suggestion_engine = SuggestionEngine(self.kb)
        self.test_runner = TestRunner(self.kb)
    
    def analyze_kb_state(self) -> Dict:
        """–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ KB"""
        stats = self.quality_analyzer.get_statistics()
        gaps = self.data_collector.identify_gaps(stats)
        suggestions = self.suggestion_engine.generate_suggestions(stats, gaps)
        
        return {
            "statistics": stats,
            "gaps": gaps,
            "suggestions": suggestions
        }
    
    def suggest_data_collection(self) -> List[Dict]:
        """–ü—Ä–µ–¥–ª–∞–≥–∞–µ—Ç, –∫–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –Ω—É–∂–Ω–æ —Å–æ–±—Ä–∞—Ç—å"""
        return self.data_collector.get_collection_suggestions()
    
    def validate_new_data(self, data: Dict) -> Tuple[bool, List[str]]:
        """–í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º"""
        return self.data_collector.validate(data)
    
    def run_tests(self, test_types: List[str] = None) -> Dict:
        """–ó–∞–ø—É—Å–∫–∞–µ—Ç —Ç–µ—Å—Ç—ã KB"""
        return self.test_runner.run_all_tests(test_types)
    
    def generate_report(self) -> str:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç—á–µ—Ç –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ KB"""
        state = self.analyze_kb_state()
        test_results = self.run_tests()
        
        return self._format_report(state, test_results)
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä—å –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —á–µ—Ä–µ–∑:

1. **API endpoints** (`web/api/librarian_routes.py`)
   - `/api/librarian/analyze` - –∞–Ω–∞–ª–∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è KB
   - `/api/librarian/suggestions` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
   - `/api/librarian/validate` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
   - `/api/librarian/test` - –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
   - `/api/librarian/report` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞

2. **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** (`web/templates/librarian_dashboard.html`)
   - –î–∞—à–±–æ—Ä–¥ —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π —Å–æ—Å—Ç–æ—è–Ω–∏—è KB
   - –§–æ—Ä–º–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
   - –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
   - –û—Ç—á–µ—Ç—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ß–µ—Ä–µ–∑ API:
```python
# –ê–Ω–∞–ª–∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è KB
response = requests.get("http://localhost:8000/api/librarian/analyze")
state = response.json()

# –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
response = requests.get("http://localhost:8000/api/librarian/suggestions")
suggestions = response.json()

# –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
response = requests.post("http://localhost:8000/api/librarian/validate", 
                        json=new_data)
is_valid, errors = response.json()
```

### –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ:
```python
from web.librarian.intelligent_librarian import IntelligentLibrarian

librarian = IntelligentLibrarian(kb_path="./mast_cells_kb")

# –ê–Ω–∞–ª–∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è
state = librarian.analyze_kb_state()
print(f"Hard Positives: {state['statistics']['hard_positives_count']}/100")

# –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
suggestions = librarian.suggest_data_collection()
for suggestion in suggestions:
    print(f"–î–æ–±–∞–≤–∏—Ç—å: {suggestion['type']} - {suggestion['reason']}")

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
test_results = librarian.run_tests(['search', 'quality'])
print(f"–ü—Ä–æ–π–¥–µ–Ω–æ —Ç–µ—Å—Ç–æ–≤: {test_results['passed']}/{test_results['total']}")
```

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
2. **–ö–∞—á–µ—Å—Ç–≤–æ** - –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º
3. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ KB
4. **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è** - –ø–æ–Ω—è—Ç–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –∏ –æ—Ç—á–µ—Ç—ã
5. **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏** - —É–º–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

